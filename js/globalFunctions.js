/**
 * Started November 19, 2009
 * @author joe
 */
var uri=window.location.toString();uri=uri.replace(window.location.hash,"");function sec2readable(c){var a;var b;c=Math.abs(c);if(c<31536000){if(c<2419200){if(c<604800){if(c<86400){if(c<3600){if(c<60){return c+" Seconds"}else{return parseInt(c/60,10)+" Minutes"}}else{return parseInt(c/3600,10)+" Hours"}}else{return parseInt(c/86400,10)+" Days"}}else{b=parseInt(c/604800,10);a="";if(b>1){a="s"}return b+" Week"+a}}else{b=parseInt(c/2419200,10);a="";if(b>1){a="s"}return b+" Month"+a}}else{b=parseInt(c/31536000,10);a="";if(b>1){a="s"}return b+" Year"+a}}function getHash(){return window.location.hash}function getHashArray(){var a=jQuery.makeArray(getHash().split("/"));return a}function setHash(a){if(getHash()!=a){window.location.hash=a}}function pageAnator(c,f,j,h){if(!h){h=0}var e=getHashArray();var g=0;c.html($("<span/>").addClass("roundAll4 lapcatButton").css({width:"auto",padding:"1px",textAlign:"center",textDecoration:"none"}).html($("<font/>").html("Pages:")));if(f===0){c.append($("<button/>").addClass("minimal nolink").attr("href",e[0]+"/"+e[1]+"/page/"+0).css({width:"20px",padding:"1px",marginRight:"2px",textAlign:"center",textDecoration:"none"}).html(1))}else{var d=f/j;if(d>10){g=parseInt(d);d=10}if(h>5){if(g==h||g<h){var k=h-9;d=parseInt(h)}else{var k=h-5;if(k<0){k=0}if(parseInt(h)+4>g){d=g}else{d=parseInt(h)+4}}}else{var k=1}for(k;k<d+1;k++){var i=parseInt(k-1,10);c.append($("<button/>").addClass("minimal nolink").attr("href",e[0]+"/"+e[1]+"/page/"+i).css({width:"20px",padding:"1px",marginRight:"2px",textAlign:"center",textDecoration:"none"}).html(k))}if(g>10){if(parseInt(h)+4<g){c.append($("<div/>",{css:{width:"10px",padding:"1px",marginRight:"2px",display:"inline-block"}}));c.append($("<button/>").addClass("minimal nolink").attr("href",e[0]+"/"+e[1]+"/page/"+g).css({width:"20px",padding:"1px",marginRight:"2px",textAlign:"center",textDecoration:"none"}).html(g))}}}}function stripslashes(a){a=a.replace(/\\'/g,"'");a=a.replace(/\\"/g,'"');a=a.replace(/\\\\/g,"\\");return a}function addBr(a){if(typeof a!="object"){a=this}a.append("<br>")}function notice(g,d,h,a,f){var i,c;if(f){c=f}else{c="http://cdn1.lapcat.org/fugue/icons/bug.png"}var e="fontReverse";switch(g){case"Error":i="minimal";c="http://cdn1.lapcat.org/fugue/bonus/icons-32/exclamation.png";e="fontMain";break;case"Debug":i="button-purple";c="http://cdn1.lapcat.org/fugue/bonus/icons-24/fire.png";e="fontReverse";break;case"Notice":i="minimal";c="http://cdn1.lapcat.org/fugue/bonus/icons-32/information.png";e="fontMain";break;case"Achievement":i="minimal";e="fontMain";c="";break;case"New Response!":i="minimal";c="http://cdn1.lapcat.org/fugue/bonus/icons-32/document-text.png";e="fontMain";break;case"New Ticket!":i="minimal";e="fontMain";c="http://cdn1.lapcat.org/fugue/bonus/icons-32/balloon.png";break;default:i="minimal ";break}var b='<div class="notice fakelink ticketlink border-B-1 ui-corner-all box_transition " ><div class="notice-body '+i+'" style="width:auto""><div style="float:left;width:40px;padding-right:5px;"><img src="'+c+'" alt="" /></div><div style="float:left;width:200px;"><h3><font class="'+e+'">'+g+'</font></h3><font class="'+e+'">'+d+"</font></div></div></div>";if(h){if(parseInt(a,10)>0){$(b).click(function(){loadTicket(a)}).purr({isSticky:true})}else{$(b).removeClass("fakelink").purr({isSticky:true})}}else{if(parseInt(a,10)>0){$(notice).click(function(){loadTicket(a)}).purr({isSticky:false})}else{$(b).removeClass("fakelink").purr({isSticky:false})}}$(".close").addClass("color-E-1")}function buildTable(d,b){var c=$("<div/>",{css:{display:"table",width:"100%"}}).addClass("generated");var a={};$.each(d,function(e,f){c.append($("<div/>",{css:{display:"table-row",width:"100%","box-sizing":"border-box","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box"}}).bind("build_row",{tableDef:f},function(g){var h=g.data.tableDef;for(var i in h){if(!h[i].o_jQ){alert(i);$(this).append($("<div/>").css({display:"table-cell","box-sizing":"border-box","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box"}).html(h[i]))}else{$(this).append($("<div/>",h[i].o_jQ).css({display:"table-cell","box-sizing":"border-box","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box"}))}}}).trigger("build_row"))});b.append(c)}function addEditControls(f,a,b,e,d){d=d?d:false;var c=a.attr("id");a.append($("<div/>",{id:c+"Edit","class":"ticket_sprite pencil fakelink",css:{display:"inline-block"}}).click(function(){var h=$(this);var i=h.parent();localStorage.setItem(i.attr("id"),i.find(".contentEdit").html());switch(b){case"textarea":var g=i.find(".contentEdit").html();i.find(".contentEdit").html($("<textarea/>",{id:"editor"}).val(g));break;default:case"text":i.find(".ticket_sprite.cross").css("display","inline-block");i.find(".ticket_sprite.tick").css("display","inline-block");g=i.find(".contentEdit").attr("contentEditable","true").focus();break;case"select":g=i.find(".contentEdit").text();i.find(".ticket_sprite.cross").css("display","inline-block");i.find(".ticket_sprite.tick").css("display","inline-block");i.find(".contentEdit").html($("<select/>").append(function(){var j="";$.each(e,function(k,l){if(l.name==g){j+="<option selected=selected value="+l.id+">"+l.name+"</option>"}else{j+="<option value="+l.id+">"+l.name+"</option>"}});return j}));break}h.css("display","none")})).append($("<div/>",{id:c+"Accept","class":"ticket_sprite tick fakelink",css:{display:"none"}}).click(function(){var g=$(this);var h=g.parent();switch(b){case"textarea":if(d){d(f,$("#editor").val(),h.attr("id"))}h.find(".contentEdit").html($("#editor").val());break;default:case"text":if(d){d(f,h.find(".contentEdit").text(),h.attr("id"))}h.find(".contentEdit").attr("contentEditable","false");break;case"select":if(d){d(f,h.find("select option:selected").val(),h.attr("id"))}h.find(".contentEdit").html(h.find("select option:selected").text());break}h.find(".ticket_sprite.pencil").css("display","inline-block");g.css("display","none");h.find(".ticket_sprite.cross").css("display","none")})).append($("<div/>",{id:c+"Cancel","class":"ticket_sprite cross fakelink",css:{display:"none"}}).click(function(){var g=$(this);var h=g.parent();h.find(".ticket_sprite.pencil").css("display","inline-block");h.find(".contentEdit").attr("contentEditable","false");g.css("display","none");h.find(".ticket_sprite.tick").css("display","none");h.find(".contentEdit").text(localStorage.getItem(h.attr("id")));localStorage.removeItem(h.attr("id"))}))}function selectBoxReplace(b,a,c){b.data("prevValue",a).html($("<select id='' name='"+b.parent().attr("id")+"' class='ticketModifyForm'/>").append(function(){var d="";$.each(c,function(e,f){if(f.name==a){d+="<option selected=selected value="+f.id+">"+f.name+"</option>"}else{d+="<option value="+f.id+">"+f.name+"</option>"}});return d}))}function textBoxReplace(b,a){b.data("prevValue",a).html($("<input type='text' name='"+b.parent().attr("id")+"' class='ticketModifyForm'/>").val(a).data("editedItem",b.attr("id")))}function textAreaReplace(b,a){b.data("prevValue",a).html($("<textarea class='ticketModifyForm' name='"+b.parent().attr("id")+"' resize='false'/>").val(a).css({height:"230px",width:"250px"}))};